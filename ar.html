<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <title>GeoAR.js demo</title>
        <script src="https://aframe.io/releases/1.0.4/aframe.min.js"></script>
        <script src="https://unpkg.com/aframe-look-at-component@0.8.0/dist/aframe-look-at-component.min.js"></script>
        <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar-nft.js"></script>
        <script src="sketch.js" defer></script>
    </head>

    <body style="margin: 0; overflow: hidden">
        <a-scene
            vr-mode-ui="enabled: false"
            embedded
            arjs="sourceType: webcam; sourceWidth:1280; sourceHeight:960; displayWidth: 1280; displayHeight: 960; debugUIEnabled: false;"
        >
            <a-camera gps-camera rotation-reader></a-camera>
            <!-- <a-entity
                crossOrigin="anonymous"
                gltf-model="./assets/magnemite/scene.gltf"
                rotation="0 180 0"
                scale="0.15 0.15 0.15"
                gps-entity-place="longitude: 22.620180; latitude: 88.350719;"
                animation-mixer
                look-at="[gps-camera]"
            /> -->
        </a-scene>

        <script>
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(async (e) => {
                    let useLat = e.coords.latitude;
                    let useLong = e.coords.longitude;

                    console.log(document.querySelector("a-scene"));

                    // let ent = document.createElement("a-entity");
                    // ent.setAttribute("gltf-model", "./assets/magnemite/scene.gltf");
                    // ent.setAttribute("rotation", "0 180 0");
                    // ent.setAttribute("gltf-model", "./assets/magnemite/scene.gltf");

                    // document.querySelector(
                    //     "a-scene"
                    // ).innerHTML += `<a-entity gltf-model="./assets/magnemite/scene.gltf" rotation="0 180 0" scale="0.15 0.15 0.15" gps-entity-place="longitude: ${useLong}; latitude: ${useLat};" animation-mixer look-at="[gps-camera]"/>`;

                    let routeData = JSON.parse(localStorage.getItem("turns"));

                    // document
                    //     .querySelector("video")
                    //     .setAttribute("kjhsad", "sadfds");

                    routeData.forEach((element) => {
                        let aText = document.createElement("a-text");
                        aText.setAttribute("look-at", "[gps-camera]");

                        aText.setAttribute(
                            "value",
                            "This content will always face you."
                        );
                        aText.setAttribute("scale", "120 120 120");
                        aText.setAttribute(
                            "gps-entity-place",
                            `"longitude: ${element[0]}; latitude: ${element[1]};"`
                        );

                        // aText.value = "This content will always face you.";
                        // aText.lookAt = "[gps-camera]";
                        // aText.scale = "120 120 120";
                        // aText.gpsEntityPlace = `"longitude: ${element[0]}; latitude: ${element[1]};"`;

                        document.querySelector("a-scene").appendChild(aText);
                        //                     document.querySelector("a-scene").innerHTML += `<a-text
                        //     value="This content will always face you."
                        //     look-at="[gps-camera]"
                        //     scale="120 120 120"
                        //     gps-entity-place="longitude: ${element[0]}; latitude: ${element[1]};"
                        //   ></a-text>`;
                        // console.log(document.querySelector("a-scene"));
                    });

                    console.log(routeData);
                });
            } else {
                document.body.innerHTML =
                    "<h3>Geolocation is not supported by this browser. Try this website from another browser.</h3>";
            }
        </script>
    </body>
</html>
